{% extends "base.html" %}

{% block pagetitle %}
    My Tickets
{% endblock %}

{% block content %}
    <div id="tf-tickets-show">

        <div class="panel panel-default">
            <div class="panel-heading">
                <div class="tf-icons"><a data-toggle="collapse" href="#tf-tickets-show-current-help"><i class="fa fa-info-circle"></i></a></div>
                <a data-toggle="collapse" href="#tf-tickets-show-current"><h4 class="panel-title">Current Tickets</h4></a>
            </div>
            <div id="tf-tickets-show-current" class="panel-collapse collapse in">
                <div class="panel-body">
                    <div id="tf-tickets-show-current-help" class="well collapse">
                        <ul>
                            <li>Tickets purchased with an eFringer can be cancelled up to one hour before the performance starts.</li>
                            <li>Tickets purchased with a credit card cannot be cancelled.</li>
                        </ul>
                    </div>
                    {% if performances_current %}
                        {% for performance in performances_current %}
                            <div class="row">
                                <div class="col-xs-12"><strong>{{ performance.show }}</strong></div>
                                <div class="col-xs-6">{{ performance.date | date:"D, jS M" }} at {{ performance.time }}</div>
                               <div class="col-xs-3"><a href="#tf-tickets-show-current-tickets-{{ forloop.counter }}" data-toggle="collapse">{{ performance.tickets | length }} Tickets</a></div>
                                <div class="col-xs-3 text-right"><a href="{% url 'tickets:print_performance' performance.id %}">Print</a></div>
                                <div id="tf-tickets-show-current-tickets-{{ forloop.counter }}" class="col-xs-12 collapse">
                                    {% for ticket in performance.tickets %}
                                        <div class="row">
                                            <div class="col-xs-1"></div>
                                            <div class="col-xs-3">{{ ticket.description }}</div>
                                            <div class="col-xs-2 text-right">{% if ticket.fringer_name %}{{ ticket.fringer_name }}{% else %}&#163;{{ ticket.cost }}{% endif %}</div>
                                            <div class="col-xs-3">{% if ticket.fringer_name %}<a href="{% url 'tickets:cancel_ticket' ticket.id %}">Cancel</a>{% endif %}</div>
                                            <div class="col-xs-3"></div>
                                        </div>
                                    {% endfor %}
                                </div>
                            </div>
                        {% endfor %}
                    {% else %}
                        You do not have any current tickets.
                    {% endif %}
                </div>
            </div>
        </div>

        <div class="panel panel-default">
            <div class="panel-heading">
                <a data-toggle="collapse" href="#tf-tickets-show-past"><h4 class="panel-title">Past Tickets</h4></a>
            </div>
            <div id="tf-tickets-show-Past" class="panel-collapse collapse in">
                <div class="panel-body">
                    {% if performances_past %}
                        {% for performance in performances_past %}
                            <div class="row">
                                <div class="col-xs-12"><strong>{{ performance.show }}</strong></div>
                                <div class="col-xs-6">{{ performance.date | date:"D, jS M" }} at {{ performance.time }}</div>
                                <div class="col-xs-3"><a href="#tf-tickets-show-past-tickets-{{ forloop.counter }}" data-toggle="collapse">{{ performance.tickets | length }} Tickets</a></div>
                                <div class="col-xs-3"></div>
                                <div id="tf-tickets-show-past-tickets-{{ forloop.counter }}" class="col-xs-12 collapse">
                                    {% for ticket in performance.tickets %}
                                        <div class="row">
                                            <div class="col-xs-1"></div>
                                            <div class="col-xs-3">{{ ticket.description }}</div>
                                            <div class="col-xs-2 text-right">{% if ticket.fringer_name %}{{ ticket.fringer_name }}{% else %}&#163;{{ ticket.cost }}{% endif %}</div>
                                            <div class="col-xs-6"></div>
                                        </div>
                                    {% endfor %}
                                </div>
                            </div>
                        {% endfor %}
                    {% else %}
                        You do not have any past tickets.
                    {% endif %}
                </div>
            </div>
        </div>

    </div>

{% endblock %}